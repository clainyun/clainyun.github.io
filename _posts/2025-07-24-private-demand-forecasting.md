---
title: "수요 예측 실습 및 사례 분석"
excerpt: "수요 예측의 다양한 기법들로 실습을 진행한다"

categories:
  - LG Aimers
  - AI Essential Course
tags:
  - [LG CNS, LG Aimers, 모델학습]

permalink: /private/91f2bd2e39b4e/

toc: true
toc_sticky: true

date: 2025-07-24
last_modified_at: 2025-07-24
---
<!-- 검색엔진 차단 -->
<meta name="robots" content="noindex, nofollow">

## 🦥 본문

## 수요예측의 다양한 기법들을 바탕으로 실제 사례를 가지고 사례 분석을 하고, 수요 예측을 하는 시간

실제 사례는 한국토지주택공사에서 사용했던 식사 비율 예측 데이터를 가지고
앞에서 공부했던 전통적 통계 기반 모델, 인공지능 모델, 시계열 모델 등을 활용해서
실제 코딩도 해보고 수요예측을 해보면서 성과를 측정해보는 시간을 가질 것임.

## 데이터 이해 및 전처리

정제되지 않은 데이터가 있음. 정원 수에서 휴가자 수라든지, 출장자 수를 빼야 함.
그래서 실제로 식사를 할 수 있는 직원들의 수가 필요하고 오른쪽에는 실제 메뉴들이 주어져 있음.

Target Value 목표 값은 식사한 인원 비율 이라고 생각하면 됨.

## 시각적 추세 파악

그래서 데이터를 분석해 보면 이론 시간에 배웠던 추세를 볼 수 있음.
빨간색 꺾은 선 그래프는 실제 인원들이 증가하고 있다는 것을 알 수 있음.
파란색 막대는 실제로 식사를 한 비율이다. 식사를 하는 비율이 감소 하다가 2019년 부터 다시 증가 하는 추세를 보임. 이유는 알 수 있지만 추세를 보인다는 것은 알 수 있다.

## 계절성 존재

계절성이 존재함.
요일별로도 계절성이 나타나고 있음.
그래서 월별 계절성과 요일별 계절성 두 가지가 존재 한다는 것을 먼저 이해해야 한다.
우리가 데이터 분석을 하기 위해서는 데이터를 이해하는 작업이 굉장히 중요함

## 예측 전에 데이터를 이해하는 것의 중요성

예측모델 적용 전에 시계열 데이터의 기본구조와 특성 파악이 필수임
제일 중요한 것이 추세가 있는지 계절성이 있는지 불규칙성만 존재 하는지 확인해야함.

데이터를 이해하지 않고 데이터의 구조를 모르고, 모델을 기계적으로 적용하면
오적합이나 과소적합, 과대적합이 발생할 수 있음.

### 1. 오적합 (Misfit)

개념
데이터의 구조를 잘못 이해해서 모델을 '엉뚱하게' 적용하는 것

예시
선형 관계가 아닌데 선형 모델을 적용함
→ 실제로는 곡선인데, 직선을 억지로 그려서 예측함

결과
데이터의 본질을 잘못 잡음 → 어떤 유형이든 예측 성능이 떨어짐
과소적합이든 과대적합이든 전부 포함될 수 있음
→ 일종의 ‘잘못된 모델 선택’이라고 보면 됩니다.

### 2. 과소적합 (Underfitting)

개념
모델이 너무 단순해서 데이터의 패턴을 못 따라감

예시
시험 문제를 외워야 하는데 단어만 기억하는 수준
날씨에 따라 아이스크림 판매가 늘어나는 데이터인데, 그냥 “항상 평균만 예측하는 모델”을 씀

결과
훈련 데이터도 예측 못 함
성능이 전반적으로 낮음

시각 예시
아래처럼 데이터가 곡선인데 직선을 억지로 씌운 경우
(단순 모델 → 너무 많은 걸 놓침)

### 3. 과대적합 (Overfitting)

개념
모델이 너무 복잡해서 훈련 데이터에 지나치게 맞춰버리는 것

예시
시험을 보기 위해 예상문제만 완벽하게 외움 → 실제 시험에선 조금만 바뀌어도 틀림
머신러닝 모델이 훈련 데이터의 '노이즈(잡음)'까지 외워버림

결과
훈련 데이터는 엄청 잘 맞추지만, 실제 예측(테스트)은 매우 약함
모델이 일반화되지 않음 (실제 데이터에 적용하면 실패)

그래서 정확한 모델 선택과 튜닝을 위하여 데이터 특성에 대한 이해로부터 적절한 데이터의 전처리 작업이 필요하고,
필요하면 추가 변수들을 고려해야 함.

## 메뉴 지수

메뉴 지수 라는 거는 다른 수요예측에는 없음. 식수인원을 예측할 때 나오는 방법으로 쓸 수 있음. 메뉴지수, 또는 선호 지수라고 하는데 임의로 이름을 붙임.

메뉴 종류에 따라서 어떠한 직원들은 채식주의자가 있을 수도 있고 어떤 직원들은 해산물을 선호 하는 직원이 있고 싫어하는 직원이 있을 것임.
그래서 크게 네 가지로 분류했음.

고기가 있을 때 없을 때 채소가 있을 때 없을 때에 대한 수요가 차이가 나기 때문에 우리가 메뉴 지수라는 것을 여러가지로 고안할 수 있지만
가장 간단한 방법은
육류가 포함된 메뉴가 나왔을 때 1, 해산물 요리가 포함 됐을 때 1, 채소가 포함 됐을 때 1인데
아까 본 결과로 해산물과 채소가 포함된 경우에는 다소 수요가 떨어짐. 그래서 -1을 곱해서 빼주는 것이다.

그래서 예시와 같이 육류는 없고 해산물이 있는 경우에는 메뉴 지수가 -1이라고 해서
상대적으로 식수 수요가 적을 것으로 예측 하겠다는 것임.

그래서 계절 지수 와 메뉴 지수 또는 선호 지수 이것들을 동시에 다 고려하겠다는 것임.

## 메인 메뉴 기반 선호 지수

또 다른 방법은 중식 메뉴의 메인 메뉴를 추출해서 각 메인 메뉴가 나왔을 때 식사 비율의 평균으로 선호지수(메뉴지수)을 산출할 수 있는데,
예를 들어 왼쪽에 데이터를 보면 과거의 훈제 오리구이 라는 메뉴가 나왔을 때 식사 비율이 되는데,
식사 비율에 대해서 평균을 뽑아보니까 41.7% 정도 나왔음

즉 이 메뉴가 나왔을 때 식사 비율이 42% 정도인데 42%는 전체 평균에 비해서는 높음.
전체 평균은 37% 정도로 직원이 천명 있으면 평균적으로 370 명이 선호 식수를 했는데 훈제 오리구이는 417명이 식수를 한거니까 상대적으로 높은 것이다.
그래서 이런 것도 선호지수로 구해서 활용할 수 있음

그리고 외부 요인 및 파생 변수로 활용할 수 있음. 예측 정확도 향상에 기여할 수 있는 변수들을 찾겠다는 것임.
그래서 실습에서는 메뉴 선호도를 반영해서 메인 메뉴 세가지에 대한 선호 지수를 산출하기로 했음.
그리고 그에 따른 중식계에 대한 데이터를 뽑았다

파생 변수 실습을 보면 데이터 전처리 작업이 필요함. 위처럼 날짜를 변환하는 것이 데이터의 전처리 작업임.

파생 변수를 생성시키기 위한 실습임. 지수를 계산하는 코드를 참고 하면 된다.
이것은 데이터를 불러와서 실제로 학습시키는 과정임.

## 실습 방식

그래서 우리는 주어진 데이터를 활용할건데, 마지막 300일은 실제 식사 비율이 주어져 있다.
하지만 우리가 그것을 모른다고 가정하고 예측을 해 볼것임.
그러면 300 일간의 마지막 데이터는 예측이 실제 발생한 거니까 얼마나 잘 예측 했는지 판단 하는 지표가 될 것임.

그래서 위에 나와있는 5가지 모델을 가지고 비교해볼 거다.
정량적 평가는 MAE(평균 절대 오차, 수요 예측치와 실제 값의 차이의 절대값), RMSE(평균 제곱근 오차, 오체 제곱의 합)
선 그래프를 활용한 오른쪽 그래프를 보면 대략적으로 예측이 잘 됐구나, 못 했구나를 평가 할 수 있음.

## 모델1: 회귀분석

기존에 주어진 데이터 셋에 대해서 최소 제곱법을 이용해서 최적의 계수들을 학습 시킬 것임.
Statsmodels 라이브러리 사이트에 들어가면 자세한 코드가 있는데 그 코드를 활용할 거임.

회귀모델에 넣을 변수들을 지정함. 예측하고자 하는 목표는 식사 비율.

### 머신러닝에서 스케일링을 해야 하는 이유

어떤 특성은 1000 단위
어떤 특성은 0.1 단위라면
머신러닝은 숫자 크기만 보고 중요도를 착각해요.

→ 그래서 백분율처럼, 스케일링으로 모든 데이터를 같은 기준(예: 0\~1)으로 맞춰주는 거예요.
이러면 기계가 공정하게 비교할 수 있어요.

### 평가 결과

R-squared(결정계수) 값이 0.695가 나옴. 결정계수는 모델이 얼마나 잘 설명하는지, 즉 설명력을 나타내는 지표
그래서 1에 가까울수록 예측이 잘 맞음. 즉, 회귀분석에서 R-squared 라는 것은 변수들이 얼마나 종속 변수를 잘 설명 하는가 이다.
보통 70% 정도가 넘으면 굉장히 잘 설명 했다고 볼 수 있음.

그리고 변수의 영향력인 p 값이 0.05 이하이면 해당 계수가 유의미 하다고 판단.
각 종속 변수의 유의미한 정도를 이 결과표를 보고 확인 할 수 있음.

성능평가는 앞에서보다는 작은 52% 값이 나옴.
설명력이 52% 정도면 수요예측을 못 했다고 하기에도 어렵고 잘했다고 하기에도 조금 아쉬운 점수임.

파란색이 300일 동안의 실제 값이고, 주황색이 회귀분석을 사용해서 예측한 값이다.

(이후 모델 2\~5 및 결론은 다음 메시지로 계속 이어드릴게요)

